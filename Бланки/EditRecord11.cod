Class  inherited СИС2.БазовыйБланкРедактор "Пример бланка редактора записи", editor Record1;
import ExampleProject Classes Consts;
import СИС2 Classes СтроковыеФункции, Исключения;

InClass Public

InObject Private

   Интерфейс                   :intRecord1;

--------------------------------------------------------------------------------
--{ Обработчики событий бланка

   proc шаблон_ПриСчитывании;
        inherited шаблон_ПриСчитывании;
        -- Вызывается при смене текущей записи в бланке-редакторе

        Интерфейс = intRecord1.create;
        Интерфейс.record = record;
        if Record.State = Kernel.Record.Created then
            Интерфейс.init;
        end;
  end;

  func шаблон_ПриЗаписи :Logical;
--        Record.ПростойНумератор = int(Record.Код);
        Result = inherited шаблон_ПриЗаписи;
        -- Вызывается при сохранении записи в бланке-редакторе
        Result = True; -- Продолжить сохранение записи
  end;


  proc btnLoadXML_OnClick(Sender :Button);

     var fName,ErrorMessage :String;
     var I : Integer;
     var xmlRootNode: XML.Node;
     var xmlNode: XML.Node;


     if ChooseFile(fName, "Выбор файла", "Данные в формате xml|*.xml") <> cmOk then
        return;
     end;

     xmlRootNode = XML.Node.Create;
     xmlRootNode.Load(fName);

       for I = 1..xmlRootNode.GetChildCount do
          xmlNode = xmlRootNode.GetChildNodes[I];
          trace(Format("%s= %s",[xmlNode.GetName,xmlNode.GetText]));
       end;
  end;

  proc btnLoadExcel_OnClick(Sender :Button);
      var fName : String;
      var ExcelApp: Excel.ExcelApp;
      var I,J: Integer;

      if ChooseFile(fName, "Выбор файла", "Данные в формате Excel|*.xls?") <> cmOk then
         return;
      end;

      ExcelApp = Excel.ExcelApp.CreateEx(fName);

      for I = 1..ExcelApp.GetRowsCount do
        for J = 1..ExcelApp.GetColumnsCount do
          trace(Format("%s= %s",[ExcelApp.GetHeaderValue(J),ExcelApp.GetCellValue(I,J)]));
        end;
      end;

      ExcelApp.CloseApp;
  end;

  proc флЗамокПриИзменении(Sender :CheckBox);
     if field3 = false then
         trace("сняли Флаг");
     else
        trace("установили флаг");
     end;
      
  end;

--}

end
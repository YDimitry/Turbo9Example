class "интерфейс ячейки";
import СИС2 classes СтроковыеФункции;
inclass

  func CreateEx(aObject:AutoObject):ICell;
    Result = inherited Create;
    Result.Cell = aObject;
  end;


inobject private
  var Cell: AutoObject;


inobject public
  var AsString: String;
  var parseError:Logical;

func asNumeric:Numeric;
  if not isEmpty then
     if not isNumber(AsString)  then
        parseError = True;
        SetError(0,"Неправильный формат числа");
     end;

     Result = Num(asString);

  end;
end;

func asInt:Integer;
  if not isEmpty then
     if not isNumber(AsString)  then
        parseError = True;
        SetError(0,"Неправильный формат числа");
     end;
      Result = Int(asString);
  end;
end;

func asDate:Date;
  if not isEmpty then

     if not Utils.isDate(AsString) then
        parseError = True;
        SetError(0,"Неправильный формат даты");
     end;
     Result = Utils.ParseDate(AsString);
  end;
end;

func isEmpty:Logical;
   return AsString = nil;
end;

end